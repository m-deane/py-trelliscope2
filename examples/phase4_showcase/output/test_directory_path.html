<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Trelliscope - Directory Path Test</title>
    <link rel="stylesheet" href="https://unpkg.com/trelliscopejs-lib@0.7.16/dist/assets/index.css">
    <style>
        body { margin: 0; padding: 0; }
        #trelliscope-root { width: 100vw; height: 100vh; }
    </style>
</head>
<body>
    <div id="trelliscope-root" class="trelliscope-not-spa"></div>

    <script type="module">
        console.log('=== DIRECTORY PATH TEST ===');

        const module = await import('https://esm.sh/trelliscopejs-lib@0.7.16?bundle');
        const initFunc = window.trelliscopeApp || module.trelliscopeApp;

        // Test 1: Path to directory (not displayInfo.json)
        console.log('Test 1: Passing directory path "./basic_viewer_demo"');
        let result = initFunc('trelliscope-root', './basic_viewer_demo');
        console.log('  Result:', typeof result);

        setTimeout(() => {
            const root = document.getElementById('trelliscope-root');
            const imgs = root.querySelectorAll('img');
            console.log('  After 2s - Images:', imgs.length);

            if (imgs.length > 0) {
                console.log('✓✓✓ SUCCESS! Directory path works!');
                imgs.forEach((img, i) => {
                    console.log(`  Panel ${i}: ${img.src}`);
                });
            } else {
                console.log('  No images with directory path.');
            }
        }, 2000);

        // Monitor fetch requests
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
            console.log('[FETCH]', args[0]);
            return originalFetch.apply(this, args);
        };
    </script>
</body>
</html>
